{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#1D4ED8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="RM Systems">
    <meta name="mobile-web-app-capable" content="yes">
    <title>RM Systems</title>
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="apple-touch-icon" href="{% static 'img/Logo_rmsys.png' %}">
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
    <link rel="stylesheet" href="{% static 'css/mobile-scroll-fix.css' %}">
    <!-- Fix específico para iOS - deve ser o último CSS -->
    <style>
      /* Fix específico para iPhone/iOS - máxima prioridade */
      @media (max-width: 768px) {
        html,
        body {
          overflow-y: auto !important;
          overflow-x: hidden !important;
          -webkit-overflow-scrolling: touch !important;
          position: relative !important;
          height: auto !important;
          min-height: 100vh !important;
          max-height: none !important;
        }
        
        .side-by-side-layout,
        .info-side,
        .login-side,
        .login-card,
        .form {
          overflow: visible !important;
          max-height: none !important;
          height: auto !important;
        }
        
        body {
          touch-action: pan-y !important;
          overscroll-behavior-y: contain !important;
          padding-bottom: 2rem !important;
        }
        
        /* Garantir que o footer não sobreponha - FORÇA MÁXIMA */
        body .login-footer,
        html body .login-footer,
        .login-footer {
          position: relative !important;
          bottom: auto !important;
          left: auto !important;
          right: auto !important;
          z-index: 1 !important;
          margin-top: 3rem !important;
          margin-bottom: 2rem !important;
          padding: 2rem 1rem !important;
        }
        
        body {
          padding-bottom: 2rem !important;
        }
        
        .login-card {
          margin-bottom: 2rem !important;
          padding-bottom: 2rem !important;
        }
        
        .form {
          margin-bottom: 1.5rem !important;
        }
        
        /* Links do footer em coluna */
        .login-footer__links {
          flex-direction: column !important;
          gap: 0.75rem !important;
        }
        
        .login-footer__links a {
          display: block !important;
          padding: 0.5rem 0 !important;
        }
        
        .login-footer__links span {
          display: none !important;
        }
      }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body data-theme="light">
    <div class="side-by-side-layout">
        <!-- Lado esquerdo - Informações -->
        <div class="info-side">
            <div class="info-content">
                <div class="info-container">
                    <h1 class="main-title">
                        <span class="title-highlight">Inovação</span> para<br>
                        conquistar<br>
                        <span class="title-highlight">resultados</span>
                    </h1>
                    <p class="main-subtitle">Verificador de viabilidade com mapas CTO</p>

                    <div class="compact-features">
                        <div class="compact-feature">
                            <h4>Precisão de análise</h4>
                            <p>Valida mapas CTO com regras consistentes.</p>
                        </div>
                        <div class="compact-feature">
                            <h4>Relatórios rápidos</h4>
                            <p>Resumo executivo em segundos.</p>
                        </div>
                        <div class="compact-feature">
                            <h4>Integração simples</h4>
                            <p>Upload direto e histórico centralizado.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lado direito - Formulário de login -->
        <div class="login-side">
            <div class="login-card">
                <div class="logo-container">
                    <img src="{% static 'img/Logo_rmsys.png' %}" alt="RM Systems" class="login-logo">
                    <span class="login-brand">RM Systems</span>
                </div>
                <h2 class="card-title">Acesse sua conta</h2>
                {% if company_slug %}
                    <p class="text-muted mb-2">Empresa: <strong>{{ company_slug }}</strong></p>
                {% endif %}

                {% if messages %}
                    <ul class="messages">
                        {% for message in messages %}
                            <li class="{{ message.tags }}">{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}

                <form method="post" class="form" id="loginForm" data-step="1">
                    {% csrf_token %}
                    <div class="form-row" id="rowEmail">
                        <label for="id_username">E-mail ou usuário</label>
                        <input type="text" name="username" id="id_username" placeholder="email@exemplo.com ou usuário" required autocomplete="username">
                    </div>

                    <div class="form-row" id="rowPassword" style="display:none">
                        <label for="id_password">Senha</label>
                        <div class="password-input-container">
                            <input type="password" name="password" id="id_password" autocomplete="current-password">
                            <button type="button" class="password-toggle" id="passwordToggle" aria-label="Mostrar senha">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="remember">
                        <input type="checkbox" id="rememberEmail" name="remember">
                        <label for="rememberEmail">Lembrar e-mail</label>
                    </div>

                    <button type="submit" class="btn primary full-width" id="actionBtn">Continuar</button>
                </form>

                <div class="footer-links">
                    <a href="/rm/login/">Entrar como RM</a>
                </div>
            </div>
        </div>
    </div>
    
    <script src="{% static 'js/login.js' %}"></script>
    <script src="{% static 'js/dark-mode.js' %}"></script>
    <!-- PWA Service Worker -->
    <script src="{% static 'js/pwa.js' %}"></script>
    <footer class="login-footer">
        <div class="login-footer__container">
            <p class="login-footer__copyright">&copy; {% now "Y" %} RM Systems. Todos os direitos reservados.</p>
            <div class="login-footer__links">
                <a href="{% url 'termos_uso' %}">Termos de Uso</a>
                <span>|</span>
                <a href="{% url 'politica_privacidade' %}">Política de Privacidade</a>
                <span>|</span>
                <a href="{% url 'politica_cookies' %}">Política de Cookies</a>
                <span>|</span>
                <a href="{% url 'faq' %}">FAQ</a>
                <span>|</span>
                <a href="{% url 'ajuda' %}">Ajuda</a>
            </div>
        </div>
        <p class="login-footer__meta">Rm Systems Tecnologia &bull; Plataforma multi-tenant segura.</p>
    </footer>
</body>
</html>